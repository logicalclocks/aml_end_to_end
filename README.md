# AML End to End Example

## Project description
This project demonstrates end to end pipeline how to train binary anti money laundering (AML) classifier based on 
Generative Adversarial Networks (GANs) and Graph embeddings. Proposed solution includes following sub sections:  

* Data load and feature engineering - We will use sample of transactions data generated by [AMLSim](https://github.com/IBM/AMLSim) 
* Feature store â€“ We use Hopsworks Feature Store to compute features, organize them as feature groups and store for 
downstream analysis, such as creating training datasets for model training, as well as retrieving them      
* Anomaly detection model - We will use keras implementation of [adversarial anomaly detection](https://arxiv.org/pdf/1905.11034.pdf) that was adapted to tabular data.
* Model serving - We will use Hopsworks model server to predict suspicious transactions. 

## Anomaly detection model
Keras implementation of [adversarial anomaly detection](https://arxiv.org/pdf/1905.11034.pdf) is provided in the folder
./adversarialaml. To use this library install as python library from https://github.com/logicalclocks/AMLend2end.git.
![intall_python_lib_from_git.gif](./images/intall_python_lib_from_git.gif)

## End to End pipeline
To successfully complete this tutorial clone this repository to your local env
```
git clone https://github.com/logicalclocks/aml_end_to_end.git
cd aml_end_to_end
echo -n [PUT YOUR API KEY] > .hw_api_key
chmod u+x run_jupyter.sh && ./run_jupyter.sh
```

### Jupyter notebooks step by step   
Run jupyter notebooks in the following order:
1) 1_create_feature_groups.ipynb 
2) 2_feature_views_and_training_dataset.ipynb
3) 3_train_deploy_serve_adversarial_aml.ipynb